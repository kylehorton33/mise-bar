<script>
	import { page } from '$app/stores';
	import { recipes, stockList } from '$lib/store';
	import { fractionHTML } from '$lib/utils';
	export let data;
	console.log('[DEBUG $page.params.slug => ]', $page.params.slug);
	const recipe = $recipes.find((recipe) => recipe.slug === $page.params.slug);
	console.log('[DEBUG "/recipes/[slug]/+page.svelte" data =>]', data.recipes[0]);
</script>

{#if recipe}
	<div class="grid gap-4 mt-12 justify-center w-72 mx-auto">
		<h1 class="text-xl text-center">{recipe.name}</h1>
		<hr />
		<ul class="list-disc list-inside">
			{#if recipe.ingredients}
				{#each recipe.ingredients as { ingredient, quantity }}
					<li class={$stockList[ingredient.name] ? '' : 'text-error-800'}>
						{@html fractionHTML(quantity)}
						{ingredient.unit}
						{ingredient.name}
					</li>
				{/each}
			{:else}
				<li>No ingredient data listed</li>
			{/if}
		</ul>
		<p class="w-72">
			{recipe.instructions}
		</p>
		{#if recipe.image}
			<img src={recipe.image} class="mt-10 mx-auto rounded-lg" alt="Missing" />
		{:else}
			<div class="placeholder h-48 flex justify-center items-center">missing image</div>
		{/if}
	</div>
{:else}
	<h1>$page.params</h1>
	<pre>{JSON.stringify($page.params, null, 2)}</pre>
	<h1>data.recipes[0]</h1>
	<pre>{JSON.stringify(data.recipes[0], null, 2)}</pre>
{/if}
